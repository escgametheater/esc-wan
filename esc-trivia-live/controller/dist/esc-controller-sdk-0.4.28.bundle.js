(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CONTROLLER_SCREEN_ORIENTATION=n.ACTION_SCREEN_ORIENTATION=n.ScreenManager=n.Screen=void 0;var o=g(t(20)),r=g(t(21)),i=g(t(22)),a=g(t(23)),s=g(t(29)),c=t(0),l=g(c),u=g(t(182)),d=t(6);function g(e){return e&&e.__esModule?e:{default:e}}var f=new u.default;function m(e){e.isTrusted&&(f.enable(),console.log("noSleep enabled!"),document.removeEventListener("click",m,!1))}document.addEventListener("click",m,!1);var p={DesiredOrientation:"landscape",DesiredPrimarySecondary:!1,AutoSizeEnabled:!0,AppModeEnabled:!0,DEBUG:!1};window.escScreen=p,window.esc.getScreen=function(){return p};var b=void 0,w=navigator.userAgent.toLowerCase().indexOf("android")>-1,h=/iPhone/.test(navigator.userAgent)&&!window.MSStream,v=(/CriOS/.test(navigator.userAgent),navigator.userAgent.toLowerCase().indexOf("samsungbrowser")>-1),E=(navigator.userAgent.toLowerCase().indexOf("chrome"),{viewable:{},viewableRotated:{}}),y=!1,_={},N={},O=!1,C={};function T(e){return{identifier:e.identifier,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY}}var I=function(e){if(p.AppModeEnabled){if(w)document.getElementById("gofullscreen").innerHTML="d "+(e.changedTouches[0].screenY-e.changedTouches[0].clientY);y=!0,A(),_=Object.assign(_,e),O||((O=T(e.changedTouches[0])).wasFullScreen=S());for(var n=0;n<e.changedTouches.length;n++){var t=e.changedTouches[n];N[t.identifier]=T(t),N[t.identifier].wasFullScreen=S(),C=T(t)}e.changedTouches[0].screenX}},S=function(){return B()<50},A=function(e){for(var n="hidden"===(e=e||S()?"hidden":"visible")?"visible":"hidden",t=document.getElementsByClassName("full-screen-hidden"),o=0;o<t.length;o++)t[o].style.visibility=e;for(var r=document.getElementsByClassName("full-screen-visible"),i=0;i<r.length;i++)r[i].style.visibility=n;e},P=function(e){p.AppModeEnabled&&(y=!0,(C=T(e.changedTouches[0])).LeftEdge=!1,A(),1===e.touches.length&&e.changedTouches[0].screenX<50?C.LeftEdge=!0:e.preventDefault())},R=function(e){y=!1;for(var n=0;n<e.changedTouches.length;n++){var t=e.changedTouches[n];delete N[t.identifier]}0===e.touches.length&&(O=!1),p.AppModeEnabled&&e.preventDefault()},D={button:1,select:1,input:1,textarea:1},M=function(e){0===e.touches.length&&(setTimeout(function(){y=!1,Y(),setTimeout(function(){Y()},100)},100),O=!1);for(var n=0;n<e.changedTouches.length;n++){var t=e.changedTouches[n];delete N[t.identifier]}var o;if(p.AppModeEnabled&&e.changedTouches[0].screenX>=50){var r=function(e){return document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}(e);console.log("TouchEndListener, GetElementUnderTouch returned ",r),(o=r)&&!D[o.tagName.toLowerCase()]&&(e.preventDefault(),e.target===r&&(e.target===document&&m(e),e.target.click&&e.target.click()))}},k=function(e){p.DEBUG&&(document.getElementById("screendebug").innerHTML=e)},L=function(){if(V()){var e=window.screen.msOrientation||(window.screen.orientation||window.screen.mozOrientation||{}).type||function(){switch(window.orientation){case 0:return"portrait-primary";case 180:return"portrait-secondary";case-90:return"landscape-primary";case 90:return"landscape-secondary"}return"undefined"}();if(e)return e}var n=document.documentElement.clientWidth;return document.documentElement.clientHeight>=n?"portrait-primary":"secondary"===p.DesiredPrimarySecondary?"landscape-secondary":"landscape-primary"},x=function(e){if(!window.esc||!window.esc.skipAutoSize){var n=document.documentElement.clientWidth,t=document.documentElement.clientHeight,o=window.screen.width,r=window.screen.height,i=L();"undefined"===i&&console.log("Screen orientation undefined. window.screen is ",window.screen);H();Y(),setTimeout(function(){Y()},100),setTimeout(function(){Y()},200);var a={screenOrientation:i,clientHeight:t,clientWidth:n,screenWidth:o,screenHeight:r};X.dispatchUI("ScreenInput:ORIENTATION",a),X.dispatchEvent("ScreenInput:ORIENTATION",a)}};function U(e,n,t,o,r,i){return"matrix("+e+","+n+","+t+","+o+","+r+","+i+")"}var j="",G="",z="",H=function(e){var n=L();if(n!==j||p.DesiredPrimarySecondary!==z||p.DesiredOrientation!==G){j=n,G=p.DesiredOrientation,z=p.DesiredPrimarySecondary,Y();var t=X.store.getState()[X.managerName],o=t.screen?{rotationDirection:t.screen.rotationDirection,rotated0:t.screen.rotated0,rotated180:t.screen.rotated180}:{};if("landscape"===p.DesiredOrientation||"portrait"===p.DesiredOrientation){var r=t?t.lastDesiredOrientation:"";p.DesiredPrimarySecondary&&(r=p.DesiredOrientation+"-"+p.DesiredPrimarySecondary);var i=n.split("-");if(null!=b){if(i[0]!==p.DesiredOrientation){var a=1;"portrait-primary"===n&&"landscape-secondary"===r?a=-1:"portrait-secondary"===n&&"landscape-primary"===r?a=-1:"landscape-secondary"===n&&"portrait-secondary"===r?a=-1:"landscape-primary"===n&&"portrait-primary"===r&&(a=-1),w&&(a=-a),b.style.transform=function(e,n,t){var o=(n-t)/2;return U(0,-e,e,0,o,-o),U(0,-e,e,0,o,-o)}(a,b.offsetHeight,b.offsetWidth),o.rotationDirection=a,o.rotated180=!1,o.rotated0=!1}else p.DesiredPrimarySecondary&&r!==n?(t.screen&&t.screen.rotated0?b.style.transform="rotate(-180deg)":b.style.transform="rotate(180deg)",o.rotationDirection=0,o.rotated180=!0,o.rotated0=!1):(t.screen&&t.screen.rotated180,b.style.transform="none",o.rotationDirection=0,o.rotated180=!1,o.rotated0=!0);return t.screen&&t.screen.rotationDirection===o.rotationDirection&&t.screen.rotated180===o.rotated180&&t.screen.rotated0===o.rotated0?{}:(console.log("new rotation: ",o,t),t.screen&&X.dispatchUI("ScreenInput:ORIENTATION",Object.assign({},t.screen,o)),o)}}else console.log('DesiredOrientation:"'+p.DesiredOrientation+'"')}};var W=function(){var e=window.innerHeight,n=window.innerWidth,t=document.documentElement.clientHeight,o=document.documentElement.clientWidth;return(n>e?Math.max(o,t):Math.min(o,t))/n},B=function(){var e=window.innerHeight,n=window.innerWidth,t=window.screen.height,o=window.screen.width;return(e>n?Math.max(t,o):Math.min(t,o))-e*W()},F=null,q=42,V=function(){return document.documentElement.clientWidth>=window.screen.width||w||h},Y=function e(){if((!window.esc||!window.esc.skipAutoSize)&&p.AutoSizeEnabled){if(y)return F&&clearTimeout(F),void(F=setTimeout(e,10));var n=document.documentElement.clientHeight,t=document.documentElement.clientWidth,o=(Math.max(n,t),Math.min(n,t),window.screen.height),r=window.screen.width;if(E.viewable={top:0,left:0,right:0,bottom:0},h&&375===r&&812===o&&3===window.devicePixelRatio&&(o-=80),w){if(r>o?r-=q=r-window.innerWidth:o-=q,"landscape"===p.DesiredOrientation){o>=r?(E.viewable.top=o-window.innerHeight-0,E.viewable.bottom=0):(E.viewable.top=o-window.innerHeight,E.viewable.right=0)}}else h&&"landscape"===p.DesiredOrientation&&(E.viewable.top=B());var i=V()?o:n,a=V()?r:t;if("portrait"===p.DesiredOrientation.toString()&&a>i||"landscape"===p.DesiredOrientation&&i>a){var s=a;a=i,i=s}var c=1;h&&1!==(c=W())&&(a/=c,i/=c,a=Math.ceil(a),i=Math.ceil(i));var l=Math.min(a,1.5*i);document.body.style.fontSize=l/50+"px",k("Dimensions "+a+"x"+i+"<br/>effective width:"+l+"<br/>fontSize: "+document.body.style.fontSize),b.style.fontSize="100%";var u=b.getBoundingClientRect();e.iPhoneVerticalCorrection=e.iPhoneVerticalCorrection||0;var d=b.offsetTop-u.top;if(Math.abs(d-e.iPhoneVerticalCorrection)>5)e.iPhoneVerticalCorrection=d;else{e.iPhoneVerticalCorrection=.5*e.iPhoneVerticalCorrection+.5*d}b.style.top=Math.round(-E.viewable.top/c+e.iPhoneVerticalCorrection)+"px",b.style.left=Math.round(-E.viewable.left/c)+"px";var g=p.DEBUG?2:0;b.style.width=a-2*g+"px",b.style.height=i-2*g+"px",b.style.border="solid red "+g+"px",E.viewableRotated={top:E.viewable.top,left:E.viewable.left,bottom:E.viewable.bottom,right:E.viewable.right};var f=document.getElementById("viewable"),m=document.getElementById("viewableSymmetric");f&&(f.style.left=E.viewableRotated.left+"px",f.style.right=E.viewableRotated.right+"px",f.style.top=E.viewableRotated.top+"px",f.style.bottom=E.viewableRotated.bottom+"px",f.style.border="solid green 4px"),m&&(m.style.left=Math.max(E.viewableRotated.left,E.viewableRotated.right)+"px",m.style.top=Math.max(E.viewableRotated.top,E.viewableRotated.bottom)+"px",m.style.right=m.style.left,m.style.bottom=m.style.top,m.style.border="solid blue 6px"),J(),A()}},J=function(){for(var e in E.viewableRotated)for(var n=document.getElementsByClassName(e+"-visible"),t=0;t<n.length;t++)n[t].style[e]=E.viewableRotated[e]+"px"},X=new d.EventManager("Screen",new d.ReducerManager((0,s.default)({},"ScreenInput:ORIENTATION",function(e,n){console.log("State,action:",e,n);var t=e.lastDesiredOrientation;n.value.screenOrientation&&(n.value.screenOrientation.split("-")[0]===p.DesiredOrientation&&(t=n.value.screenOrientation));return Object.assign({},e,{lastDesiredOrientation:t,lastScreen:Object.assign({},e.screen),screen:Object.assign({},e.screen,n.value),zoom:W(),innerWidth:window.innerWidth,innerHeight:window.innerHeight,rect:b.getBoundingClientRect()})}))),K=function(e){function n(){return(0,o.default)(this,n),(0,i.default)(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return(0,a.default)(n,e),(0,r.default)(n,[{key:"componentDidMount",value:function(){((b=document.getElementById("controllerId")).style.touchAction="none",b.style.overflow="hidden",Z(this.props.captureTouchEvents),x(),A(),p.AppModeEnabled||p.AutoSizeEnabled)&&document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0");setInterval(H,200)}},{key:"render",value:function(){var e=this.props,n=e.desiredOrientation,t=void 0===n?"landscape":n,o=e.androidOrientation,r=void 0!==o&&o,i=e.iPhoneOrientation,a=void 0!==i&&i,s=e.autoSizeEnabled,c=void 0===s||s,u=e.appModeEnabled,d=void 0===u||u;r&&w?t=r:a&&h&&(t=a);var g=t.split("-",2);return p.DesiredOrientation=g[0],p.DesiredPrimarySecondary=g[1],p.AutoSizeEnabled=c,A(),J(),p.AppModeEnabled=d,p.DEBUG?l.default.createElement("div",null,l.default.createElement("div",{style:{position:"absolute",zIndex:-1,top:0,left:0,width:"50%",height:"50%",border:"1px dashed gray"}}),l.default.createElement("div",{style:{position:"absolute",zIndex:-1,bottom:0,right:0,width:"50%",height:"50%",border:"1px dashed gray"}}),l.default.createElement("div",{style:{position:"absolute",zIndex:-1,top:0,right:0,width:"50%",height:"50%",border:"1px dashed gray"}}),l.default.createElement("div",{style:{position:"absolute",zIndex:-1,bottom:0,left:0,width:"50%",height:"50%",border:"1px dashed gray"}}),l.default.createElement("div",{id:"screendebug",style:{position:"fixed",top:"30%",left:"10%",backgroundColor:"black",padding:"1em",color:"red"}})):null}}]),n}(c.Component),Q=X.connect(K,["ScreenInput:ORIENTATION"]);E.viewable={top:0,bottom:0,left:0,right:0},E.viewableRotated={top:0,bottom:0,left:0,right:0};var Z=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];window.addEventListener("resize",x,!0),window.addEventListener("scroll",x,!1),e&&(b.addEventListener("touchstart",I,!1),b.addEventListener("touchmove",P,!1),b.addEventListener("touchend",M,!0),b.addEventListener("touchcancel",R,!1)),window.addEventListener("contextmenu",function(e){e.preventDefault()},!1)};n.Screen=Q,n.ScreenManager=X,n.ACTION_SCREEN_ORIENTATION="ScreenInput:ORIENTATION",n.CONTROLLER_SCREEN_ORIENTATION="ScreenInput:ORIENTATION"},158:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.publishToAggregator=n.connectionData=n.NetworkDisconnectController=n.EVENT_NETWORK_OPEN=n.EVENT_NETWORK_ERROR=n.ESCNetworkState=n.ESCNetworking=void 0;var o=p(t(20)),r=p(t(21)),i=p(t(22)),a=p(t(23)),s=p(t(29)),c=t(0),l=p(c),u=t(159),d=t(99),g=t(89),f=t(6),m=p(t(61));function p(e){return e&&e.__esModule?e:{default:e}}var b=!0;console.log("Loading ESCNetworking.js");window.testWebsocketPaused=!1;var w=function(e){for(var n=e+"=",t=decodeURIComponent(document.cookie).split(";"),o=0;o<t.length;o++){var r=t[o].trim();if(0===r.indexOf(n))return r.substring(n.length,r.length)}return""},h=sessionStorage.getItem("controllerUuid");h||(h=(0,m.default)(),sessionStorage.setItem("controllerUuid",h));var v=window.location.hostname,E=8887,y="no_device_id",_="no_guest_hash",N=0,O=0,C="no_request_id",T="no_session_hash",I=3,S="invalid",A="";if(window.getWindowEscFromOtherPage=function(e){var n=window.open(e);window.escpopup=n,console.log("Opening window "+e,n),setTimeout(function(){n.postMessage("send window.esc",e),console.log("Send message to "+e)},500)},window.addEventListener("message",function(e){if(!e.origin.startsWith("http://localhost:300")&&!e.origin.match(/^http:\/\/[a-z0-9][a-z0-9-]*[a-z0-9]\.local:300[0-9]/)&&!e.origin.match(/^https:\/\/[a-z0-9][a-z0-9-]*[a-z0-9]\.esc.games/))return void console.log("Message received from bad origin:",e);console.log("Message received:",e),"send window.esc"===e.data?(e.source.postMessage({esc:window.esc},e.origin),window.close()):e.data.esc&&(console.log("window.esc received: ",e.data.esc),window.esc=e.data.esc,sessionStorage.setItem("window.esc",JSON.stringify(window.esc)))},!1),window.UsingTestESC=!1,void 0===window.esc){console.log("window.esc is undefined, trying to use test window.esc");try{var P=t(!function(){var e=new Error("Cannot find module '../../test/testWindowEsc'");throw e.code="MODULE_NOT_FOUND",e}());console.warn("Loading local test window.esc."),window.esc=P,window.UsingTestESC=!0}catch(e){console.error("No window.esc or test file found.")}if(!window.esc){console.log("Trying to get window.esc from sessionStorage");var R=sessionStorage.getItem("window.esc");if(R)try{window.esc=JSON.parse(R),console.log("window.esc loaded from sessionStorage"),window.UsingTestESC=!1}catch(e){window.esc=null}}window.esc||(window.esc={global:{notifications:[],has_notifications:!1,debug_mode_enabled:!1,has_session_messages:!1,session_messages:[],user:{id:30,name:"TestUser",groups:[],permissions:{},is_verified:!1,email:"",timezone_offset:0,ip:"127.0.0.1",cache:{},is_authenticated:!0,dst_auto:0,dst:0,isMobile:!1,isTablet:!1,isPhone:!1,is_bot:"0",beta_access:!0,entity:{},session:{},applicationUserAccessToken:null,session_entity:{type:"SessionEntity"},guest_entity:{type:"GuestEntity"}},config:{static_url:"/static/",media_url:"/media/",images_url:"/static/images/",raw_js:!0,raw_css:!0,is_dev:!1,ga_id:"UA-123681863-1",www_url:"https://www.esc.games",play_url:"https://play.esc.games",develop_url:"https://develop.esc.games",api_url:"https://api.esc.games"},request:{request_id:Math.random(),request_et_id:null,request_checksum:null,request_utm_medium:null,request_utm_source:null,request_utm_campaign:null,request_utm_term:null,get:[],build_query:"?",section:"i",page_content_audience:1,ajax:!1,page:"play"}},page:{host_instance:{type:"HostInstanceEntity",public_host_domain:"qa1.playesc.com",public_host_name:"2f358fe9b41e47d4af368c7ef51edebe",local_port:"8888",host:{type:"HostEntity"},network:{type:"NetworkEntity",is_active:"1"},game_instances:{type:"NetworkEntity",is_active:"1"},user_is_host_admin:!0},game_instance:{type:"GameInstanceEntity",game:{type:"GameEntity"},game_build:{type:"GameBuildEntity"},game_controllers:{type:"GameBuildEntity"},custom_game_assets:[]},user_is_host_admin:!0,invite_hash:null,controller_pub_sub_channels:{}}},window.UsingTestESC=!0),window.esc.global.request.guest_hash||(""===(_=w("guestHash"))&&(_="player-"+Math.random()),window.esc.global.request.guest_hash=_),_=window.esc.global.request.guest_hash}else sessionStorage.setItem("window.esc",JSON.stringify(window.esc));if(void 0!==window.esc){var D=window.esc,M=D.page.host_instance;M&&(M.local_ip_address&&!UsingTestESC&&(v=M.local_url,E=M.local_port),O=M.id),D.page.game_instance&&(N=D.page.game_instance.id),y=D.global.request.guest_hash,T=D.global.request.session_hash,C=D.global.request.request_id,_=D.global.request.guest_hash,A=D.page.invite_hash,I=D.global.user.id,S=D.global.user.connectionNonce,console.log("ESC Host Instance",D.page.host_instance),console.log("ESC Game Instance",D.page.game_instance),b&&!window.esc.page.pub_nub_config&&(console.warn("PubNub config not set, disabling PubNub. window.esc.page is ",window.esc.page),b=!1)}else console.warn("window.esc is still undefined."),window.esc={};window.esc.isOfflineGame=function(){try{return-1===window.esc.page.game_instance.id}catch(e){console.log("host_instance not found")}return!1},window.esc.isAggregateGame=function(){try{return window.esc.page.game_instance.game.is_aggregate_game}catch(e){console.log("is_aggregate_game not found")}return!1},window.esc.isHostAdmin=function(){try{return window.esc.page.user_is_host_admin}catch(e){console.log("is_aggregate_game not found")}return!1};var k="https:"!==window.location.protocol?"ws":"wss",L={deviceId:y,gameInstanceId:N,hostInstanceId:O,controllerBuildId:"no_controller_build_id",gameBuildId:1,requestId:C,sessionHash:T,userId:I,guestHash:_,inviteHash:A,wasConnected:!1,connectionNonce:S},x=new URL(window.location.href),U=new URLSearchParams(x.search);!function(e){for(var n in e)e.hasOwnProperty(n)&&U.has(n)&&(e[n]=U.get(n))}(L),U.has("port")&&(E=U.get("port")),L.userId=parseInt(L.userId),L.gameBuildId=parseInt(L.gameBuildId),L.gameInstanceId=parseInt(L.gameInstanceId),L.hostInstanceId=parseInt(L.hostInstanceId),U.has("pubnub")?b=U.get("pubnub"):L.hostInstanceId||(b=!1),console.log("connectionData after setFromParams:",Object.assign({},L)),document.cookie="guestHash="+_;var j={port:E,uri:k+"://"+v+":"+E,myIP:null,ackFrequency:.1,ackFrequencyCount:1,reconnectDelay:500,autoReconnect:!0,player:{deviceId:y,username:_,controllerUuid:h},messageSinceLastPing:!0,pingStats:{count:0,avg:0,totalMs:0,countLong:0,totalMsLong:0},useWebsocket:!0,websocket:{},messagesSent:0,messagesReceived:0,startTime:(new Date).getTime(),closeCode:0,refusedCode:0,connected:!1,wasConnected:!1,disconnectCount:0,playTime:0,pubNubActive:!1,usePubNub:b};window.esc.isAggregateGame()&&(window.esc.isHostAdmin()||(j.useWebsocket=!1,console.log("Aggregate game, not using webSockets.")));var G=new f.EventManager("ESCNetworking"),z=1,H=!1,W=function(){return F.eventAsURLfield("RegisterController",{username:_,controllerUuid:h,deviceId:y})};function B(){if(window.testWebsocketPaused)setTimeout(B,1e3);else if(console.log("ESCNetworking: connecting["+z+"] - "+j.uri),j.websocket&&j.websocket.readyState===WebSocket.OPEN)console.log("ESCNetworking: ALREADY CONNECTED["+z+"]");else{var e="/"+JSON.stringify(L),n=H?"?"+W():"";j.websocket=new WebSocket(j.uri+e+n),j.websocket.onopen=F.onOpen(z),j.websocket.onclose=F.onClose(z),j.websocket.onmessage=F.onMessage(z),j.websocket.onerror=F.onError(z),j.websocket.binaryType="arraybuffer",z++}}var F={state:j,messageQueue:[],init:function(){F.newConnection()},eventAsURLfield:function(e,n){return e+"="+encodeURIComponent(JSON.stringify(n))},newConnection:function(){j.useWebsocket&&B(),j.usePubNub&&setTimeout(function(){F.newPubNubConnection()},1)},newPubNubConnection:function(){(0,u.startPubNub)(L,F.dispatchEvent,function(){j.pubNubActive=!0,F.dispatchUI("Network:Connection",j),!window.esc.isAggregateGame()||window.esc.isHostAdmin()?F.sendControllerRegister():console.log("Aggregate game, not sending controllerRegister "),j.connected||F.dispatchEvent("NetworkOpen",j),L.wasConnected=!0,j.wasConnected=!0},function(){j.pubNubActive=!1,console.log("pubNub onDisconnection"),F.dispatchUI("Network:Connection",j)},function(){j.pubNubActive=!0,F.dispatchUI("Network:Connection",j),j.connected||F.dispatchEvent("NetworkOpen",j)})},initPlayerId:function(){var e=w("playerid"),n=L.playerId;return n=(n=n||e)||"player-"+Math.random(),document.cookie="playerid="+n,L.playerId=n,F.playerId=n,n},getPlayerId:function(){return F.playerId||F.initPlayerId(),F.playerId},sendControllerRegister:function(){F.sendCommand("RegisterController",{username:_,controllerUuid:h,deviceId:y})},onOpen:function(e){return function(n){console.log("ESCNetworking: CONNECTED{"+e+"]"),j.messageSinceLastPing=!0,F.keepalive(e),j.disconnectCount=0,j.connected=!0,F.sendControllerRegister(),F.dispatchUI("Network:Connection",j),j.pubNubActive||F.dispatchEvent("NetworkOpen",j),L.wasConnected=!0,j.wasConnected=!0}},onClose:function(e){return function(n){j.username="",j.connected?j.closeCode=n.code:j.refusedCode=n.code,clearInterval(F.keepaliveInterval[e]),console.log("ESCNetworking: DISCONNECTED["+e+"]",n,n.code,j.websocket.readyState),!window.esc.isOfflineGame()&&j.autoReconnect&&(j.disconnectCount++,j.disconnectCount<5?B():(5===j.disconnectCount&&(console.log("dispatching ACTION_NETWORK_ERROR ESCNetworking ",g.ESCManager),F.dispatchUI("Network:Connection",j),F.dispatchEvent("NetworkError",j)),setTimeout(function(){B()},5e3))),j.connected=!1}},ab2str:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))},onMessage:function(e){return function(e){if(!window.testWebsocketPaused){j.messageSinceLastPing=!0;var n=F.ab2str(e.data);if(1!==n.length){n.charAt(0);var t=n.substring(1);F.dispatchRawEvent(t),j.messagesReceived++,j.playTime=(new Date).getTime()-j.startTime,g.ESCManager.dispatchUI(g.ACTION_GAME_LOADED,j)}}}},onError:function(e){return function(e){console.log("ESCNetworking: ERROR["+e.code+"]: ",e),j.websocket.readyState===WebSocket.CONNECTING&&d.DebugManager.commands.notify("Unable to connect to "+j.uri)}},pinger:function(e,n,t){if(1!==e){e--;var o=setInterval(function(){j.websocket.readyState===WebSocket.OPEN&&F.sendCommand("Ping",{time:Date.now(),message:t}),1!==e?(j.messageSinceLastPing=!1,(e-=1)<=0&&(e=0)):clearInterval(o)},n);return!j.messageSinceLastPing&&j.pingStats.count?(console.log("No message since last ping, disconnecting"),F.closeConnection(),void clearInterval(o)):o}F.sendCommand("Ping",{time:Date.now(),message:t})},keepaliveInterval:{},keepalive:function(e){null==F.keepaliveInterval[e]&&(F.keepaliveInterval[e]=F.pinger(0,400,"keepalive"))},_send:function(e){if(j.websocket.readyState!==WebSocket.OPEN)return F.messageQueue.push(e),void(F.messageQueue.length>10?(F.messageQueue.shift(),console.log("ESCNetworking: Attempt to send when disconnected - queue full, shifting out message")):console.log("ESCNetworking: Attempt to send when disconnected - queuing message"));window.testWebsocketPaused||j.websocket.send(e),j.messagesSent++},closeConnection:function(){console.log("ESCNetworking: Closing websocket"),j.websocket.close()},sendCommand:function(e,n){"Ping"===e||!j.pubNubActive&&!window.esc.isOfflineGame()||j.websocket.readyState===WebSocket.OPEN?F._send("e"+e+":"+JSON.stringify(n)):(0,u.pubNubSendEvent)(e,n)},setUsername:function(e){j.username!==e&&(j.username=e,F._send("u"+j.username))},sendUpdateWebsocket:function(e,n){j.usernamePlayer=j.username;var t=[];n.shift(),n.forEach(function(e,n){t.push(e.value)}),F.sendJSON({keys:e,values:t})},sendUpdate:function(e,n){F.sendUpdateWebsocket(e,n)},sendJSON:function(e){F.setUsername(j.usernamePlayer),F._send("s"+JSON.stringify(e))},log:function(e,n,t,o){b?(0,u.pubNubLog)(e,n,t,o):F.sendCommand("Log",e)}};Object.assign(F,G),F.registerEventHandler("Pong",f.HANDLER_GROUP_DEFAULT,function(e){var n=Date.now(),t=e.time;if(t>0){var o=n-t;o<1e3?(j.pingStats.totalMs+=o,j.pingStats.count++,j.pingStats.avg=Math.round(j.pingStats.totalMs/j.pingStats.count)):(j.pingStats.totalMsLong+=o,j.pingStats.countLong++,console.log("Network Latency: "+o+", greater than 1 second; not counted in total. Assumed to be a disconnection or game server not running."))}g.ESCManager.dispatchUI(g.ACTION_GAME_LOADED,j)}),F.registerEventHandler("ControllerRegistered",f.HANDLER_GROUP_DEFAULT,function(e){j.player.deviceId=e.deviceId,j.player.username=e.username,j.player.controllerUuid=e.controllerUuid,g.ESCManager.dispatchUI(g.ACTION_GAME_LOADED,j)}),F.registerEventHandler("Reload",f.HANDLER_GROUP_DEFAULT,function(e){window.location=e.url}),console.log("Done loading ESCNetworking.js"),window.escNetworking=F,window.escNetworkState=j,F.initPlayerId(),F.registerEventHandler("NetworkError",f.HANDLER_GROUP_DEFAULT,function(e){console.log("Network error, closeCode: "+e.closeCode+" refusedCode: "+e.refusedCode+" disconnectCount: "+e.disconnectCount)});var q=new f.ReducerManager((0,s.default)({},"Network:Connection",function(e,n){console.log("ReducerManager:",q);var t=Object.assign({},e,{closeCode:n.value.closeCode,refusedCode:n.value.refusedCode,connected:n.value.connected,wasConnected:e.wasConnected||e.connected,disconnectCount:n.value.disconnectCount,pubNubActive:n.value.pubNubActive});return console.log("ReducerManager returns: ",t),t})),V=new f.EventManager("ESCNetworking",q),Y=function(e){function n(){return(0,o.default)(this,n),(0,i.default)(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return(0,a.default)(n,e),(0,r.default)(n,[{key:"render",value:function(){console.log("NetworkDisconnectComponent: ",this.props);var e=this.props.connected||this.props.pubNubActive?"":l.default.createElement("div",{className:"network-disconnect"},this.props.wasConnected?"Lost connection. Attempting to reconnect...":"Unable to connect..."),n=this.props.pubNubActive?l.default.createElement("div",{className:"pubnub-active pubnub-status"},"PN"):l.default.createElement("div",{className:"pubnub-inactive pubnub-status"},"PN"),t=this.props.connected?l.default.createElement("div",{className:"websocket-active websocket-status"},"WS"):l.default.createElement("div",{className:"websocket-inactive websocket-status"},"WS");return l.default.createElement("div",null,e,t,n)}}]),n}(c.Component);window.SwitchWebSocketPort=function(e){E=e,j.port=E,j.uri=k+"://"+v+":"+E,j.websocket&&j.websocket.readyState===WebSocket.OPEN&&(F.closeConnection(),B())};var J=V.connect(Y,["Network:Connection"]);n.ESCNetworking=F,n.ESCNetworkState=j,n.EVENT_NETWORK_ERROR="NetworkError",n.EVENT_NETWORK_OPEN="NetworkOpen",n.NetworkDisconnectController=J,n.connectionData=L,n.publishToAggregator=u.publishToAggregator},159:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getGamePlayerDirectChannel=n.pubNubLog=n.publishToAggregator=n.pubNubSendEvent=n.pubNubSend=n.stopPubNub=n.startPubNub=void 0;var o=r(t(160));r(t(61));function r(e){return e&&e.__esModule?e:{default:e}}var i="Ping",a="Connected",s="log.",c=1e4,l=250,u=!1,d=!1,g=!1,f=null,m=!1;window.testPubNubPaused=!1;var p=15,b=1,w=p,h=null,v=null,E=null;function y(){try{return window.esc.page.game_instance.pub_nub_channels.game_broadcast.channel_name}catch(e){return console.error("Unable to find game_broadcast channel.",e),null}}function _(){try{return window.esc.page.game_instance.pub_nub_channels.game_config.channel_name}catch(e){return console.warn("Unable to find game_state channel. Using game_broadcast channel instead",e),y()}}function N(e){var n=null;if(window.UsingTestESC)e&&(n="host-"+e);else try{n=window.esc.page.game_instance.pub_nub_channels.game_direct.channel_name}catch(e){return console.warn("Unable to find game_direct channel. Using game_broadcast channel instead",e),null}return n}function O(e){return s+e.gameInstanceId}var C=!1,T=!1,I=!1,S=!0;window.stopPubNubPingerAndDisconnect=function(){!1,clearTimeout(A),L()};var A=!1;function P(e,n,t){u&&(console.log("Pinging via PubNub, messageReceivedSinceLastPing: "+S+", sending message:",t),j(i,{time:Date.now(),message:t}),S||L(),S=!1,1!==e?(!0,A=setTimeout(function(){P(e<1?0:e-1,n,t)},n)):!1)}function R(){console.log("PubNub dispatchEvent() not defined.")}function D(){console.log("PubNub disconnect.")}function M(){console.log("PubNub reconnect."),W()}function k(){console.log("PubNub connected.")}function L(){d&&D(),S=!1,d=!1}function x(e){!window.testPubNubPaused&&C&&(0===w&&(console.warn("PubNub publish rate limit warning, more than "+p+" messages in last "+(1===b?"":b)+"s.",e),w+=p),w--,setTimeout(function(){w++},1e3*b),e.replyChannel=T,u.publish({channel:C,message:e},function(n,t){n.error&&(console.error("PubNub error sending message to "+C,e,n,t),L())}))}function U(e,n,t,o){window.testPubNubPaused||(n=n||I,o=o||1e3,void 0===t&&(t=100),u.publish({channel:n,message:e},function(r,i){r.error&&(console.error("PubNub error sending log message to "+n+(t?". Will retry in "+o/1e3+" seconds.":". Will not retry."),e,r,i),t&&setTimeout(function(){U(e,n,t-1,o)},o))}))}function j(e,n){x({eventName:e,body:n})}function G(){try{var e=window.esc.page.game_instance.pub_nub_channels.game_aggregate_pub.channel_name;return e.startsWith("aggregate.")?e:"aggregate."+window.esc.page.game_instance.id}catch(e){console.warn("Unable to find game aggregate channel.",e);try{return"aggregate."+window.esc.page.game_instance.id}catch(e){return console.warn("Unable to find game_instance.id",e),!1}}}function z(e,n,t,o,r){return!(!o||o<0)&&(r=r||l,console.log("Retrying publishToAggregator in "+r/1e3),setTimeout(function(){H(e,n,t,o-1,r)},r),!0)}function H(e,n,t,o,r){if(!u)return console.error("publishToAggregator called but pubNub is not initialized."),z(e,n,t,o,r),!1;if(!u.fire)return console.error("publishToAggregator called but pubNub.fire is not available."),z(e,n,t,o,r),!1;var i=G();if(!i)return console.warn("publishToAggregator called before game instance set"),z(e,n,t,o,r),!1;var a=Date.now();return u.fire({channel:i,message:e},function(s,c){var l=Date.now(),u=l-a;if(s.error){var d={error:"Error publishing to aggregator",status:s,response:c,channel:i,message:e,userId:window.esc.global.user.id,sessionId:window.esc.global.user.session_entity.id,requestTime:a,responseTime:l,delayTime:u,retries:o};"PNTimeoutCategory"===s.category?console.error("Error PNTimeoutCategory publishing to aggregator, requestTime "+a+" responseTime "+l+" delayTime "+u):"getaddrinfo"===s.errorData.syscall?(console.error("Error publishing to aggregator: "+s.errorData.syscall+" code "+s.errorData.code),d.syscall=s.errorData.syscall,d.code=s.errorData.code):console.error("Error publishing to aggregator: ",s,c),U(d),z(e,n,t,o,r)||n&&n(s.error)}else t&&t(c),console.log("Published to aggregator channel "+i,e)}),!0}function W(e){console.log("Getting last state message");var n=function(n){return function(o,r){try{if(o.error)return console.error("getLastState history returned error.",n,o,r),void t(n);if(!r.messages)return console.error("getLastState returned no messages.",n,o,r),void t(n);if(!r.messages.length)return console.error("getLastState returned empty list of messages.",n,o,r),void t(n);r.messages[0].timetoken;var i=r.messages[0].entry;i.eventName&&(console.log("PubNub dispatching last state message",n,i),R(i.eventName,i.body)),console.log("last message:",n,r.messages[0]),e&&e(o,r)}catch(e){console.error("Error exception getting state history. Is history enabled for this pubnub keyset?",e)}}};function t(e){e!==v&&u.history({channel:v,count:1,stringifiedTimeToken:!0},n(v))}u.history({channel:E,count:1,stringifiedTimeToken:!0},n(E))}function B(){var e=[T];v&&e.push(v),h&&e.push(h),console.log("Subscribing to PubNub channels",e),u.subscribe({channels:e})}function F(){if(!m&&C){f.replyChannel=T;var e={connectionData:Object.assign({},f),replyChannel:T};u.publish({channel:C,message:e},function(n,t){n.error?(console.error("PubNub error sending connectionData to "+C,e,n,t),L()):console.log("PubNub connectionData sent to "+C,e,n,t)})}}window.pubNubPinger=P,n.startPubNub=function(e,n,t,r,s){if(u)return!1;var l=window.esc.page.pub_nub_config;return l?((f=e).origin=window.location.origin,T=function(e){try{return window.esc.page.game_instance.pub_nub_channels.game_player_direct.channel_name}catch(e){return console.warn("Unable to find game_direct channel. Not subscribing to anything",e),null}}(),l.uuid=T,u=new o.default(l),console.log(u),u.publish,R&&(R=n),t&&(k=t),r&&(D=r),s&&(M=function(){s(),W()}),h=function(){try{return window.esc.page.game_instance.pub_nub_channels.offline_broadcast.channel_name}catch(e){return console.error("Unable to find offline_broadcast channel.",e),null}}(),window.esc.isOfflineGame()?(v=h,E=_(),null,C=h.replace("broadcast","game"),I=O(f)):window.esc.isAggregateGame()?(v=y(),E=_(),G(),C=window.esc.isHostAdmin()?N(f.hostInstanceId):null,I=O(f)):(v=y(),E=_(),null,C=N(f.hostInstanceId),I=O(f)),u.addListener({status:function(e){switch(e.category){case"PNConnectedCategory":console.log("PubNub connected status event",e),W(),j(i,{time:Date.now(),message:e.category});break;case"PNNetworkUpCategory":console.log("PubNub network UP status event",e),B();break;case"PNTimeoutCategory":case"PNBadRequestCategory":case"PNNetworkDownCategory":case"PNAccessDeniedCategory":case"PNUnknownCategory":case"PNNetworkIssuesCategory":console.log("PubNub status event, treating as disconnect",e),L();break;default:console.log("Unexpected PubNub status event",e)}},message:function(e){if(e.channel===E?console.log("Game state message received",e):e.channel===v?console.log("Broadcast message received",e):console.log("Regular message received",e),window.testPubNubPaused)console.log("PubNub test paused, received message ",e);else{if(e.message.eventName===a)return m?console.error("PubNub received a second "+a+" message."):(d=!0,g=!0,k()),void(m=!0);d||(g?(d=!0,M()):!window.esc.isOfflineGame()&&C&&F()),S=!0,e.message.eventName&&R(e.message.eventName,e.message.body)}}}),B(),console.log("PubNub Host channel: "+C),!window.esc.isOfflineGame()&&C?(F(),P(0,c,"pubnub")):console.log("Not starting pubnub pinger."),Object.keys(window.esc.page.game_instance.pub_nub_channels).forEach(function(e){console.log(e,window.esc.page.game_instance.pub_nub_channels[e])}),u):(console.log("No pubNub config, not starting PubNub"),!1)},n.stopPubNub=function(){if(!u)return!1;u.stop(),u=!1,L()},n.pubNubSend=x,n.pubNubSendEvent=j,n.publishToAggregator=H,n.pubNubLog=U,n.getGamePlayerDirectChannel=function(){return T}},173:function(e,n,t){var o=t(62);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},i=t(12)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(62,function(){var n=t(62);if("string"==typeof n&&(n=[[e.i,n,""]]),!function(e,n){var t,o=0;for(t in e){if(!n||e[t]!==n[t])return!1;o++}for(t in n)o--;return 0===o}(o.locals,n.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");i(n)}),e.hot.dispose(function(){i()})},175:function(e,n,t){var o=t(63);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},i=t(12)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(63,function(){var n=t(63);if("string"==typeof n&&(n=[[e.i,n,""]]),!function(e,n){var t,o=0;for(t in e){if(!n||e[t]!==n[t])return!1;o++}for(t in n)o--;return 0===o}(o.locals,n.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");i(n)}),e.hot.dispose(function(){i()})},177:function(e,n,t){e.exports=t.p+"static/media/swipe_up.1e5fab0d.gif"},178:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ESCGameController=void 0;var o=p(t(20)),r=p(t(21)),i=p(t(22)),a=p(t(23)),s=t(0),c=p(s),l=t(75),u=p(t(179)),d=t(180),g=t(100),f=t(24),m=t(183);function p(e){return e&&e.__esModule?e:{default:e}}window.frameRateMetrics=m.frameRateMetrics;var b=(0,f.initializeStore)({}),w=function(e){function n(){return(0,o.default)(this,n),(0,i.default)(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return(0,a.default)(n,e),(0,r.default)(n,[{key:"render",value:function(){var e=this.props,n=e.controllerId,t=void 0===n?"controllerId":n,o=e.debug,r=e.game,i=e.includeESCLogo,a=void 0===i||i,s=e.desiredOrientation,f=void 0===s?"landscape":s,m=e.iPhoneOrientation,p=void 0!==m&&m,w=e.androidOrientation,h=void 0!==w&&w,v=e.autoSizeEnabled,E=void 0===v||v,y=e.appModeEnabled,_=void 0===y||y,N=e.captureTouchEvents,O=void 0===N||N;return c.default.createElement(l.Provider,{store:b},c.default.createElement("div",null,c.default.createElement("div",{id:"scrollableDiv",style:{fontSize:"20vmin",opacity:0,lineHeight:.7,visibility:"visible",width:"10%",position:"relative",zIndex:10}},"E E E E E E E E E E E E E E E E E E E E E E E E E E E E",c.default.createElement("br",null)),c.default.createElement("div",{id:"gofullscreen",className:"full-screen-hidden"},String.fromCharCode(9757),c.default.createElement("br",null),String.fromCharCode(9757),c.default.createElement("br",null),String.fromCharCode(9757),c.default.createElement("br",null)),c.default.createElement("div",{id:t,style:{position:"fixed",left:0,top:0,zIndex:1}},a?c.default.createElement("header",{className:"controller-header"},c.default.createElement("img",{src:u.default,className:"App-logo",alt:"logo",style:{background:"#000"}})):null,c.default.createElement("div",{className:"controller-"+r},this.props.children,o?c.default.createElement("div",null,c.default.createElement(d.DebugNotifications,null)):null),c.default.createElement(g.Screen,{desiredOrientation:f,iPhoneOrientation:p,androidOrientation:h,autoSizeEnabled:E,appModeEnabled:_,captureTouchEvents:O}))))}}]),n}(s.Component);n.ESCGameController=w},179:function(e,n,t){e.exports=t.p+"static/media/esc-logo.edadb777.png"},180:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(181);Object.defineProperty(n,"EventStats",{enumerable:!0,get:function(){return o.EventStats}});var r=t(99);Object.defineProperty(n,"DebugManager",{enumerable:!0,get:function(){return r.DebugManager}}),Object.defineProperty(n,"DebugNotifications",{enumerable:!0,get:function(){return r.DebugNotifications}})},181:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventStats=void 0;var o=d(t(29)),r=d(t(20)),i=d(t(21)),a=d(t(22)),s=d(t(23)),c=t(0),l=d(c),u=t(75);function d(e){return e&&e.__esModule?e:{default:e}}n.EventStats=function(e){var n=e.map(function(e){return e.managerName});e.forEach(function(e){if(!e.hasOwnProperty("ACTION_EVENT_STATS")||!e.hasOwnProperty("managerName"))throw console.log("Not an event manager",e),new Error("Not an event manager")});var t=function(n){function t(){return(0,r.default)(this,t),(0,a.default)(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return(0,s.default)(t,n),(0,i.default)(t,[{key:"UNSAFE_componentWillMount",value:function(){e.forEach(function(e){return e.setReducerEnabled(e.ACTION_EVENT_STATS,!0)})}},{key:"componentWillUnmount",value:function(){e.forEach(function(e){return e.setReducerEnabled(e.ACTION_EVENT_STATS,!1)})}},{key:"render",value:function(){return l.default.createElement("div",null,l.default.createElement("pre",null,JSON.stringify(this.props,null,2)))}}]),t}(c.Component);return(0,u.connect)(function(e){return{eventStats:n.reduce(function(n,t){return Object.assign({},n,(0,o.default)({},t,e[t]?e[t].eventStats:{}))},{})}},function(e){return{}})(t)}},183:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o={lastFrameTimeStamp:0,lastFrameTimeDelta:0,minTimeDelta:Number.MAX_VALUE,frameCount:0,warnDelta:34};requestAnimationFrame(function e(n){o.frameCount++,o.lastFrameTimeStamp&&(o.lastFrameTimeDelta=n-o.lastFrameTimeStamp,o.lastFrameTimeDelta,o.warnDelta,o.minTimeDelta=Math.min(o.minTimeDelta,o.lastFrameTimeDelta),o.warnDelta=Math.max(34,o.minTimeDelta+1)),o.lastFrameTimeStamp=n,requestAnimationFrame(e)}),n.frameRateMetrics=o},233:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ACTION_ACCELEROMETER_ENABLED=n.ACTION_ACCELEROMETER_MOTION=n.CONTROLLER_ACCELEROMETER_MOTION=n.DefaultDeviceMotionHandler=n.DeviceMotion=n.AccelerometerManager=n.Accelerometer=n.GRAVITY=void 0;var o,r=g(t(20)),i=g(t(21)),a=g(t(22)),s=g(t(23)),c=g(t(29)),l=t(0),u=g(l),d=t(6);function g(e){return e&&e.__esModule?e:{default:e}}n.GRAVITY=9.81;var f=!1,m=!1,p=!1,b=0,w=function(e){var n=Date.now();if(m||(m=n),b){var t=n-p,o=(e.interval<1?1e3*e.interval:e.interval).toFixed(2);t>1.5*o&&console.warn("Performance slow! devicemotion interval "+o+" last "+(n-p)+" total per second "+b/(n-m)*1e3)}b++,p=n;var r=e.accelerationIncludingGravity;r&&null!=r.x?(f||(f=!0,v.dispatchUI("AccelerometerInput:ENABLED",f),console.log("AccelerometerInput is now available.",e)),v.dispatchEvent("AccelerometerInput:MOTION",r),v.dispatchUI("AccelerometerUI:MOTION",{acc:r,accInterval:e.interval})):!0===f&&(console.log("AccelerometerInput not available on this device. Control with taps, swipes, or keyboard."),f=!1,v.dispatchUI("AccelerometerInput:ENABLED",f))},h=new d.ReducerManager((o={},(0,c.default)(o,"AccelerometerUI:MOTION",function(e,n){return Object.assign({},e,{acc:n.value.acc})}),(0,c.default)(o,"AccelerometerInput:ENABLED",function(e,n){return Object.assign({},e,{enabled:n.value})}),o)),v=new d.EventManager("Accelerometer",h),E=function(e){function n(){return(0,r.default)(this,n),(0,a.default)(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return(0,s.default)(n,e),(0,i.default)(n,[{key:"render",value:function(){var e=this.props,n=(e.acc,e.enabled);return u.default.createElement("div",null,u.default.createElement("div",null,"Accelerometer ",n?u.default.createElement("span",null,"Raw"):u.default.createElement("span",null,"Unavailable"),u.default.createElement("pre",null,JSON.stringify(this.props,null,2))))}}]),n}(l.Component),y=v.connect(E,["AccelerometerInput:ENABLED","AccelerometerUI:MOTION"]),_={config:{thresh:.05,filterThresh:.01,fc:.75},filteredAcc:{x:0,y:0,z:0},lastAcc:{x:0,y:0,z:0},xyzDiff:function(e,n){return{x:e.x-n.x,y:e.y-n.y,z:e.z-n.z}},RoundToFraction:function(e,n){return Math.round(e*n)/n},accRound:function(e){return _.RoundToFraction(e,1024)},handle:function(e){if(e&&null!=e.x){var n=Date.now(),t=_.xyzDiff(e,_.lastAcc),o=n-_.lastUpdateTime,r=_.config.thresh,i=_.config.filterThresh,a=_.config.fc;_.filteredAcc={x:_.filteredAcc.x*a+(1-a)*e.x,y:_.filteredAcc.y*a+(1-a)*e.y,z:_.filteredAcc.z*a+(1-a)*e.z};var s=_.xyzDiff(_.filteredAcc,_.lastAcc),c=t.x>r||t.x<-r||t.y>r||t.y<-r||t.z>r||t.z<-r;((c=c||s.x>i||s.x<-i||s.y>i||s.y<-i||s.z>i||s.z<-i)||o>1e3)&&(e={x:_.accRound(e.x),y:_.accRound(e.y),z:_.accRound(e.z)},_.lastUpdateTime=n,d.ESCManager.networking.sendCommand("AccelerometerData",e))}}};console.log("ESC Input: Registering AccelerometerInput"),void 0===window.DeviceMotionEvent?(f=!1,v.dispatchUI("AccelerometerInput:ENABLED",!1),console.log("AccelerometerInput not available on this device. Control with buttons, swipes, or keys.")):(console.log("window.DeviceMotionEvent available."),window.ondevicemotion=w);var N=_.handle;n.Accelerometer=y,n.AccelerometerManager=v,n.DeviceMotion=_,n.DefaultDeviceMotionHandler=N,n.CONTROLLER_ACCELEROMETER_MOTION="AccelerometerInput:MOTION",n.ACTION_ACCELEROMETER_MOTION="AccelerometerUI:MOTION",n.ACTION_ACCELEROMETER_ENABLED="AccelerometerInput:ENABLED"},6:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(24);Object.defineProperty(n,"EventManager",{enumerable:!0,get:function(){return o.EventManager}}),Object.defineProperty(n,"HANDLER_GROUP_DEFAULT",{enumerable:!0,get:function(){return o.HANDLER_GROUP_DEFAULT}}),Object.defineProperty(n,"ReducerManager",{enumerable:!0,get:function(){return o.ReducerManager}}),Object.defineProperty(n,"initializeStore",{enumerable:!0,get:function(){return o.initializeStore}});var r=t(89);Object.defineProperty(n,"ESCManager",{enumerable:!0,get:function(){return r.ESCManager}}),Object.defineProperty(n,"GameState",{enumerable:!0,get:function(){return r.GameState}}),Object.defineProperty(n,"ACTION_GAME_LIST",{enumerable:!0,get:function(){return r.ACTION_GAME_LIST}}),Object.defineProperty(n,"ACTION_GAME_LOADED",{enumerable:!0,get:function(){return r.ACTION_GAME_LOADED}}),Object.defineProperty(n,"ACTION_GAME_CHANGED",{enumerable:!0,get:function(){return r.ACTION_GAME_CHANGED}}),Object.defineProperty(n,"ACTION_NETWORK_ERROR",{enumerable:!0,get:function(){return r.ACTION_NETWORK_ERROR}});var i=t(178);Object.defineProperty(n,"ESCGameController",{enumerable:!0,get:function(){return i.ESCGameController}})},62:function(e,n,t){(e.exports=t(11)(!1)).push([e.i,".ribbon {\n    font-size: 16px !important;\n    /* This ribbon is based on a 16px font side and a 24px vertical rhythm. I've used em's to position each element for scalability. If you want to use a different font size you may have to play with the position of the ribbon elements */\n\n    position: absolute;\n    background: #ba89b6;\n    color: #fff;\n    text-align: center;\n    padding: 1em 2em; /* Adjust to suit */\n    margin: 2em auto 3em; /* Based on 24px vertical rhythm. 48px bottom margin - normally 24 but the ribbon 'graphics' take up 24px themselves so we double it. */\n}\n.ribbon:before, .ribbon:after {\n    content: \"\";\n    position: absolute;\n    display: block;\n    bottom: -0.25em;\n    border: 1.5em solid #986794;\n    z-index: -1;\n}\n.ribbon:before {\n    left: -2em;\n    border-right-width: 1.5em;\n    border-left-color: transparent;\n}\n.ribbon:after {\n    right: -2em;\n    border-left-width: 1.5em;\n    border-right-color: transparent;\n}\n.ribbon .ribbon-content:before, .ribbon .ribbon-content:after {\n    content: \"\";\n    position: absolute;\n    display: block;\n    border-style: solid;\n    border-color: #804f7c transparent transparent transparent;\n    bottom: -0.25em;\n}\n.ribbon .ribbon-content:before {\n    left: 0;\n    border-width: 1em 0 0 1em;\n}\n.ribbon .ribbon-content:after {\n    right: 0;\n    border-width: 1em 1em 0 0;\n}",""])},63:function(e,n,t){n=e.exports=t(11)(!1);var o=t(176)(t(177));n.push([e.i,".visible {\n    visibility: visible;\n    opacity: 1;\n    -webkit-transition: opacity 177ms ease-out;\n    -o-transition: opacity 177ms ease-out;\n    transition: opacity 177ms ease-out;\n}\n\n.hidden {\n    visibility: hidden;\n    opacity: 0;\n    -webkit-transition: visibility 0s 250ms, opacity 250ms ease-in-out;\n    -o-transition: visibility 0s 250ms, opacity 250ms ease-in-out;\n    transition: visibility 0s 250ms, opacity 250ms ease-in-out;\n}\ndiv {\n    font-size: 100%;\n}\nimg\n{\n    -webkit-user-select:none; /* Prevent image selection popups */ /* Konqueror HTML */\n    -moz-user-select: none; /* Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently\n                                  supported by Chrome and Opera */\n    -webkit-touch-callout:none;\n}\n#root {\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */ /* Konqueror HTML */\n    -moz-user-select: none; /* Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently\n                                  supported by Chrome and Opera */\n}\n\n.bottom-visible {\n    position: absolute;\n    bottom:0;\n}\n.right-visible {\n    position: absolute;\n    right:0;\n}\n.top-visible {\n    position: absolute;\n    top:0;\n}\n.left-visible {\n    position: absolute;\n    left:0;\n}\n\n.tattooSize {\n    width:6.25em;\n    height:6.25em;\n}\n\n.tattooBarContainer {\n    position: absolute;\n    bottom: 0;\n    width: 100%;\n    background: black;\n}\n\n.tattooBarContainer .escLogo {\n    width: 7%;\n    display: inline-block;\n    vertical-align: middle;\n}\n\n.tattooBarContainer .spacer {\n    width: 87%;\n    height: 4.5em;\n    display: inline-block;\n    vertical-align: middle;\n}\n\n.tattooBar {\n    width: 6%;\n    display: inline-block;\n    vertical-align: middle;\n}\n\n.tattooBar .tattooSize {\n    width: 100%;\n    height: 100%;\n    float: right;\n}\n\n.network-disconnect {\n    position: absolute;\n    top: 50% ;\n    left: 50% ;\n    -webkit-transform: translateY(-50%) translateX(-50%);\n    -ms-transform: translateY(-50%) translateX(-50%);\n    transform: translateY(-50%) translateX(-50%);\n    padding: 1em;\n    background-color: #222222;\n    color: #ba89b6;\n}\n\n.pubnub-inactive {\n    text-decoration: line-through;\n}\n\n.websocket-inactive {\n    text-decoration: line-through;\n}\n\n.pubnub-status {\n    position: fixed;\n    top: 0;\n    right : 3em;\n}\n\n.websocket-status {\n    position: fixed;\n    top: 0;\n    right : 5em;\n}\n\n#gofullscreen {\n    position: fixed;\n    top:0;\n    left:0;\n    z-index:5;\n    font-size:0em;\n    width:5vmax;\n    height:20vmax;\n    background-image: url("+o+");\n    background-repeat: no-repeat;\n    background-size: 100%;\n}\n",""])},80:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(100);Object.defineProperty(n,"Screen",{enumerable:!0,get:function(){return o.Screen}}),Object.defineProperty(n,"ScreenManager",{enumerable:!0,get:function(){return o.ScreenManager}}),Object.defineProperty(n,"ACTION_SCREEN_ORIENTATION",{enumerable:!0,get:function(){return o.ACTION_SCREEN_ORIENTATION}}),Object.defineProperty(n,"CONTROLLER_SCREEN_ORIENTATION",{enumerable:!0,get:function(){return o.CONTROLLER_SCREEN_ORIENTATION}});var r=t(233);Object.defineProperty(n,"Accelerometer",{enumerable:!0,get:function(){return r.Accelerometer}}),Object.defineProperty(n,"AccelerometerManager",{enumerable:!0,get:function(){return r.AccelerometerManager}}),Object.defineProperty(n,"DefaultDeviceMotionHandler",{enumerable:!0,get:function(){return r.DefaultDeviceMotionHandler}}),Object.defineProperty(n,"GRAVITY",{enumerable:!0,get:function(){return r.GRAVITY}}),Object.defineProperty(n,"CONTROLLER_ACCELEROMETER_MOTION",{enumerable:!0,get:function(){return r.CONTROLLER_ACCELEROMETER_MOTION}}),Object.defineProperty(n,"ACTION_ACCELEROMETER_MOTION",{enumerable:!0,get:function(){return r.ACTION_ACCELEROMETER_MOTION}}),Object.defineProperty(n,"ACTION_ACCELEROMETER_ENABLED",{enumerable:!0,get:function(){return r.ACTION_ACCELEROMETER_ENABLED}})},89:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ACTION_GAME_CHANGED=n.ACTION_GAME_LOADED=n.ACTION_GAME_LIST=n.GameState=n.ESCManager=void 0;var o,r=f(t(29)),i=f(t(20)),a=f(t(21)),s=f(t(22)),c=f(t(23)),l=t(0),u=f(l),d=t(158),g=t(24);function f(e){return e&&e.__esModule?e:{default:e}}t(175);var m=function(e){function n(){return(0,i.default)(this,n),(0,s.default)(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return(0,c.default)(n,e),(0,a.default)(n,[{key:"render",value:function(){var e=this.props.debug;return u.default.createElement("div",null,e?u.default.createElement("pre",null,JSON.stringify(this.props,null,2)):null)}}]),n}(l.Component),p=new g.ReducerManager((o={},(0,r.default)(o,"ESC:Loaded",function(e,n){return Object.assign({},e,{network:Object.assign({},n.value)})}),(0,r.default)(o,"ESC:Changed",function(e,n){return b.currentGame=n.value,Object.assign({},e,{game:Object.assign({},e.game,{gameId:n.value})})}),(0,r.default)(o,"ESC:List",function(e,n){return Object.assign({},e,{gameList:n.value})}),o),{game:{gameId:"none",gameIsLoaded:"xyz"},network:{},debug:!0}),b=new g.EventManager("ESCManager",p);b.networking=d.ESCNetworking,d.ESCNetworking.init(),b.getCustomAssetUrl=function(e){var n=window.esc.page.game_instance.custom_game_assets;return n&&n.hasOwnProperty(e)?n[e]:null};var w=b.connect(m,["ESC:List","ESC:Loaded","ESC:Changed"]);n.ESCManager=b,n.GameState=w,n.ACTION_GAME_LIST="ESC:List",n.ACTION_GAME_LOADED="ESC:Loaded",n.ACTION_GAME_CHANGED="ESC:Changed"},99:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DebugNotifications=n.DebugManager=void 0;var o,r=m(t(29)),i=m(t(163)),a=m(t(20)),s=m(t(21)),c=m(t(22)),l=m(t(23)),u=t(0),d=m(u);t(173);var g=m(t(61)),f=t(24);function m(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function n(){return(0,a.default)(this,n),(0,c.default)(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return(0,l.default)(n,e),(0,s.default)(n,[{key:"render",value:function(){return d.default.createElement("div",null,d.default.createElement("pre",null,this.props.notifications.map(function(e,n){return d.default.createElement(b,{key:e.uuid,alert:e})}),JSON.stringify(this.props,null,2)))}}]),n}(u.Component),b=function(e){function n(){return(0,a.default)(this,n),(0,c.default)(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return(0,l.default)(n,e),(0,s.default)(n,[{key:"render",value:function(){var e=this.props.alert,n=e.uuid,t=e.message,o=e.top,r=e.left,i=e.timeout,a=e.createTime+i>(new Date).getTime()-300?"visible":"hidden";return d.default.createElement("div",{id:n,className:"ribbon "+a,style:{top:o,left:r}},t)}}]),n}(u.Component),w=new f.EventManager("Debug",new f.ReducerManager((o={},(0,r.default)(o,"NOTIFY",function(e,n){return Object.assign({},e,{notifications:[].concat((0,i.default)(e.notifications),[n.value])})}),(0,r.default)(o,"ACTION_DEBUG_NOTIFY_EXPIRE",function(e,n){return Object.assign({},e,{notifications:[].concat((0,i.default)(e.notifications.filter(function(e){return e.uuid!==n.value})))})}),o),{notifications:[]}));w.commands={notify:function(e,n,t,o){var r=(0,g.default)();w.dispatchUI({type:"NOTIFY",value:{uuid:r,message:e,createTime:(new Date).getTime(),timeout:n||5e3,top:t||"38%",left:o||"53%"}}),setTimeout(function(){w.dispatchUI({type:"ACTION_DEBUG_NOTIFY_EXPIRE",value:r})},n)}};var h=w.connect(p);n.DebugManager=w,n.DebugNotifications=h}}]);